
  <head>
    <title>Human Circuit</title>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
    <title>something</title>

  </head>
  <body>
    <div id="exercise1" class="simcir"></div>
    <div id="exercise2" class="simcir"></div>
    <div id="exercise3" class="simcir"></div>
    <div id="exercise4" class="simcir"></div>
    <script>

    // parameters
    var config = {}; // { "gates": 0, "seats": 0, "rows": 0, "xoffset": 0, "yoffset": 0};
    config.gates = 64;
    config.seats = 8;
    config.rows = config.gates/config.seats;
    config.xoffset = 152 - 96;
    config.yoffset = 128 - 80;

    // variables
    function layout(config, gate) {
      var xs = config.xoffset;
      var ys = config.yoffset;
      var devices = [];
      var connectors = [];

      devices.push({
        "type": "DC",
        "id": "dev0",
        "x": xs,
        "y": config.yoffset*(config.seats/2),
        "label": "DC"
      });
      xs += config.xoffset;

      for(i=1; i<=config.rows; i++) {
        for(j=1; j<=config.seats; j++) {
          var id = (i-1)*(config.seats)+j;
          var pid = (i-2)*(config.seats)+j;

          if(i==1) {
            devices.push({"type":"Toggle","id": "dev" + id, "x":xs,"y":ys,"label":"Toggle " + id});
            connectors.push({"from":"dev0.out0","to": "dev" + id + ".in0"});
          } else if(i==config.rows) {
            devices.push({"type":"LED","id": "dev" + id, "x":xs,"y":ys,"label":"LED " + id});
            connectors.push({"from":"dev" + pid + ".out0","to": "dev" + id + ".in0"});
          } else {
            var g = gate(config, pid, id, xs, ys);
            devices.push(g.device);
            Array.prototype.push.apply(connectors, g.connectors);
          }
          ys += config.yoffset;
        }
        ys = config.yoffset;
        xs += config.xoffset;
      }
      var values = {
        "width": config.rows*config.xoffset+2*config.xoffset,
        "height": config.seats*config.yoffset+2*config.yoffset,
        "showToolbox": false,
        "devices": devices,
        "connectors": connectors
      };
      return values;
    }

    function exercise1(config, pid, id, xs, ys) {
      return {
        device: {"type":"NOT","id": "dev" + id, "x":xs,"y":ys,"label":"NOT " + id},
        connectors: [{"from":"dev" + pid + ".out0","to": "dev" + id + ".in0"}]
      }
    }

    function exercise2(config, pid, id, xs, ys) {
      var offset;
      if((id % config.seats)==0) {
        offset = -1;
      } else {
        offset = 1;
      }
      return {
        device: {"type":"AND","id": "dev" + id, "x":xs,"y":ys,"label":"AND " + id},
        connectors: [
          {"from":"dev" + pid + ".out0","to": "dev" + id + ".in0"},
          {"from":"dev" + (pid + offset) + ".out0","to": "dev" + id + ".in1"},
        ]
      }
    }

    function exercise3(config, pid, id, xs, ys) {
      var offset;
      if((id % config.seats)==0) {
        offset = -1;
      } else {
        offset = 1;
      }
      return {
        device: {"type":"OR","id": "dev" + id, "x":xs,"y":ys,"label":"OR " + id},
        connectors: [
          {"from":"dev" + pid + ".out0","to": "dev" + id + ".in0"},
          {"from":"dev" + (pid + offset) + ".out0","to": "dev" + id + ".in1"},
        ]
      }
    }

    function exercise4(config, pid, id, xs, ys) {
      var offset;
      if((id % config.seats)==0) {
        offset = -1;
      } else {
        offset = 1;
      }
      return {
        device: {"type":"EOR","id": "dev" + id, "x":xs,"y":ys,"label":"EOR " + id},
        connectors: [
          {"from":"dev" + pid + ".out0","to": "dev" + id + ".in0"},
          {"from":"dev" + (pid + offset) + ".out0","to": "dev" + id + ".in1"},
        ]
      }
    }

    $("#exercise1").text(JSON.stringify(layout(config, exercise1)));
    $("#exercise2").text(JSON.stringify(layout(config, exercise2)));
    $("#exercise3").text(JSON.stringify(layout(config, exercise3)));
    $("#exercise4").text(JSON.stringify(layout(config, exercise4)));
    </script>
  </body>
